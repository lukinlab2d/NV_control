import pyvisa as visa
import sys
from qcodes.instrument.base import Instrument
from qcodes.instrument.parameter import Parameter

class TEK710():
    def __init__(self, name='TEK710', TEKnum=1, settings=None, **kwargs) -> None:
        rm = visa.ResourceManager()
        if TEKnum == 1:
            self.TEK = rm.open_resource('GPIB1::1::INSTR')
            self.TEK.query('*IDN?')

    def open_file(self, filename):
        self.TEK.write('MMEM:NAME "' + filename + '","MAIN";OPEN')

    def start_output(self):
        self.TEK.write('AWGControl:RUN:IMMediate')

    def stop_output(self):
        self.TEK.write('AWGControl:STOP:IMMediate')

    def set_runmode(self, runmode):
        self.TEK.write('AWGControl:RMODe ' + runmode)
        # runmode: CONT, TRIG, GAT, ENH